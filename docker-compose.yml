services:
  web:
    build: .
    container_name: mini-pesapal-web
    ports:
      - "5000:5000"
    volumes:
      # Mount database file to persist data
      - ./pesapal_demo.josedb:/app/pesapal_demo.josedb
    environment:
      - FLASK_ENV=development
    restart: unless-stopped

  repl:
    build: .
    container_name: mini-pesapal-repl
    stdin_open: true  # Keep stdin open (like -i flag)
    tty: true         # Allocate pseudo-TTY (like -t flag)
    volumes:
      # Share the same database file with web service
      - ./pesapal_demo.josedb:/app/pesapal_demo.josedb
    command: python main.py pesapal_demo.josedb
    profiles:
      - repl  # Don't start automatically with 'up', only with explicit 'run' or 'up --profile repl'

